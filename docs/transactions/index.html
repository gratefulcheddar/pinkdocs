



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.2">
    
    
      
        <title>Transactions - PinkDocs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.9b572555.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Lato","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="pink" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#opcodes" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PinkDocs" class="md-header-nav__button md-logo">
          
            <img src="../img/PinkLogo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PinkDocs
              </span>
              <span class="md-header-nav__topic">
                Transactions
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Introduction" class="md-tabs__link md-tabs__link--active">
        Introduction
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../img/PinkLogo.svg" width="24" height="24">
      
    </span>
    PinkDocs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../block-chain/" title="Blockchain" class="md-nav__link">
      Blockchain
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Transactions
      </label>
    
    <a href="./" title="Transactions" class="md-nav__link md-nav__link--active">
      Transactions
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#opcodes" title="OpCodes" class="md-nav__link">
    OpCodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#address-conversion" title="Address Conversion" class="md-nav__link">
    Address Conversion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raw-transaction-format" title="Raw Transaction Format" class="md-nav__link">
    Raw Transaction Format
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#txin-a-transaction-input-non-coinbase-txin" title="TxIn: A Transaction Input (Non-Coinbase) {#txin}" class="md-nav__link">
    TxIn: A Transaction Input (Non-Coinbase) {#txin}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outpoint-the-specific-part-of-a-specific-output-outpoint" title="Outpoint: The Specific Part Of A Specific Output {#outpoint}" class="md-nav__link">
    Outpoint: The Specific Part Of A Specific Output {#outpoint}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#txout-a-transaction-output-txout" title="TxOut: A Transaction Output {#txout}" class="md-nav__link">
    TxOut: A Transaction Output {#txout}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coinbase-input-the-input-of-the-first-transaction-in-a-block-coinbase" title="Coinbase Input: The Input Of The First Transaction In A Block {#coinbase}" class="md-nav__link">
    Coinbase Input: The Input Of The First Transaction In A Block {#coinbase}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compactsize-unsigned-integers" title="CompactSize Unsigned Integers" class="md-nav__link">
    CompactSize Unsigned Integers
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../p2p/" title="P2P Network" class="md-nav__link">
      P2P Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="Pinkcoin API" class="md-nav__link">
      Pinkcoin API
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#opcodes" title="OpCodes" class="md-nav__link">
    OpCodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#address-conversion" title="Address Conversion" class="md-nav__link">
    Address Conversion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raw-transaction-format" title="Raw Transaction Format" class="md-nav__link">
    Raw Transaction Format
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#txin-a-transaction-input-non-coinbase-txin" title="TxIn: A Transaction Input (Non-Coinbase) {#txin}" class="md-nav__link">
    TxIn: A Transaction Input (Non-Coinbase) {#txin}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outpoint-the-specific-part-of-a-specific-output-outpoint" title="Outpoint: The Specific Part Of A Specific Output {#outpoint}" class="md-nav__link">
    Outpoint: The Specific Part Of A Specific Output {#outpoint}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#txout-a-transaction-output-txout" title="TxOut: A Transaction Output {#txout}" class="md-nav__link">
    TxOut: A Transaction Output {#txout}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coinbase-input-the-input-of-the-first-transaction-in-a-block-coinbase" title="Coinbase Input: The Input Of The First Transaction In A Block {#coinbase}" class="md-nav__link">
    Coinbase Input: The Input Of The First Transaction In A Block {#coinbase}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compactsize-unsigned-integers" title="CompactSize Unsigned Integers" class="md-nav__link">
    CompactSize Unsigned Integers
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Transactions</h1>
                
                <h2 id="opcodes">OpCodes</h2>
<p>The opcodes used in the pubkey scripts of standard transactions are:</p>
<ul>
<li>
<p>Various data pushing opcodes from 0x00 to 0x4e (1--78). These aren't
  typically shown in examples, but they must be used to push
  signatures and public keys onto the stack.</p>
</li>
<li>
<p><code>OP_TRUE</code>/<code>OP_1</code> (0x51) and <code>OP_2</code> through <code>OP_16</code> (0x52--0x60), which
  push the values 1 through 16 to the stack.</p>
</li>
<li>
<p><code>OP_CHECKSIG</code> consumes a signature and a full public key, and pushes
  true onto the stack if the transaction data specified by the SIGHASH flag was
  converted into the signature using the same ECDSA private key that
  generated the public key.  Otherwise, it pushes false onto the stack.</p>
</li>
<li>
<p><code>OP_DUP</code> pushes a copy of the topmost stack item on to the stack.</p>
</li>
<li>
<p><code>OP_HASH160</code> consumes the topmost item on the stack,
  computes the RIPEMD160(SHA256()) hash of that item, and pushes that hash onto the stack.</p>
</li>
<li>
<p><code>OP_EQUAL</code> consumes the top two items on the stack, compares them, and
  pushes true onto the stack if they are the same, false if not.</p>
</li>
<li>
<p><code>OP_VERIFY</code> consumes the topmost item on the stack.
  If that item is zero (false) it terminates the script in failure.</p>
</li>
<li>
<p><code>OP_EQUALVERIFY</code> runs <code>OP_EQUAL</code> and then <code>OP_VERIFY</code> in sequence.</p>
</li>
<li>
<p><code>OP_CHECKMULTISIG</code> consumes the value (n) at the top of the stack,
  consumes that many of the next stack levels (public keys), consumes
  the value (m) now at the top of the stack, and consumes that many of
  the next values (signatures) plus one extra value.</p>
<p>The "one extra value" it consumes is the result of an off-by-one
error in the Bitcoin Core implementation. This value is not used, so
signature scripts prefix the list of secp256k1 signatures with a
single OP_0 (0x00).</p>
<p><code>OP_CHECKMULTISIG</code> compares the first signature against each public
key until it finds an ECDSA match. Starting with the subsequent
public key, it compares the second signature against each remaining
public key until it finds an ECDSA match. The process is repeated
until all signatures have been checked or not enough public keys
remain to produce a successful result.</p>
<p>Because public keys are not checked again if they fail any signature
comparison, signatures must be placed in the signature script using
the same order as their corresponding public keys were placed in
the pubkey script or redeem script. See the <code>OP_CHECKMULTISIG</code> warning
below for more details.</p>
</li>
<li>
<p><code>OP_RETURN</code> terminates the script in failure when executed.</p>
</li>
</ul>
<p>A complete list of opcodes can be found in the <code>opcodetype</code> enum
of the Pinkcoin script header file (script.h).</p>
<p><img alt="Warning icon" src="../img/icon_warning.svg" />
<strong>Signature script modification warning:</strong>
Signature scripts are not signed, so anyone can modify them. This
means signature scripts should only contain data and data-pushing opcodes
which can't be modified without causing the pubkey script to fail.
Placing non-data-pushing opcodes in the signature script currently
makes a transaction non-standard, and future consensus rules may forbid
such transactions altogether. (Non-data-pushing opcodes are already
forbidden in signature scripts when spending a P2SH pubkey script.)</p>
<p><img alt="Warning icon" src="../img/icon_warning.svg" />
<strong><code>OP_CHECKMULTISIG</code> warning:</strong> The multisig verification process
described above requires that signatures in the signature script be
provided in the same order as their corresponding public keys in
the pubkey script or redeem script. For example, the following
combined signature and pubkey script will produce the stack and
comparisons shown:</p>
<pre><code>OP_0 &lt;A sig&gt; &lt;B sig&gt; OP_2 &lt;A pubkey&gt; &lt;B pubkey&gt; &lt;C pubkey&gt; OP_3

Sig Stack       Pubkey Stack  (Actually a single stack)
---------       ------------
B sig           C pubkey
A sig           B pubkey
OP_0            A pubkey

1. B sig compared to C pubkey (no match)
2. B sig compared to B pubkey (match #1)
3. A sig compared to A pubkey (match #2)

Success: two matches found
</code></pre>

<p>But reversing the order of the signatures with everything else the same
will fail, as shown below:</p>
<pre><code>OP_0 &lt;B sig&gt; &lt;A sig&gt; OP_2 &lt;A pubkey&gt; &lt;B pubkey&gt; &lt;C pubkey&gt; OP_3

Sig Stack       Pubkey Stack  (Actually a single stack)
---------       ------------
A sig           C pubkey
B sig           B pubkey
OP_0            A pubkey

1. A sig compared to C pubkey (no match)
2. A sig compared to B pubkey (no match)

Failure, aborted: two signature matches required but none found so
                  far, and there's only one pubkey remaining
</code></pre>

<h2 id="address-conversion">Address Conversion</h2>
<p>The hashes used in P2PKH and P2SH outputs are commonly encoded as Bitcoin
addresses.  This is the procedure to encode those hashes and decode the
addresses.</p>
<p>First, get your hash.  For P2PKH, you RIPEMD-160(SHA256()) hash a ECDSA
public key derived from your 256-bit ECDSA private key (random data).
For P2SH, you RIPEMD-160(SHA256()) hash a redeem script serialized in the
format used in raw transactions (described in a [following
sub-section][raw transaction format]).  Taking the resulting hash:</p>
<ol>
<li>
<p>Add an address version byte in front of the hash.  The version
bytes commonly used by Pinkcoin are:</p>
<ul>
<li>
<p>0x03 for P2PKH addresses on the main Pinkcoin network (mainnet)</p>
</li>
<li>
<p>0x37 for P2PKH addresses on the Pinkcoin testing network (testnet)</p>
</li>
<li>
<p>0x1c for P2SH addresses on mainnet</p>
</li>
<li>
<p>0xc4 for P2SH addresses on testnet</p>
</li>
</ul>
</li>
<li>
<p>Create a copy of the version and hash; then hash that twice with SHA256: <code>SHA256(SHA256(version . hash))</code></p>
</li>
<li>
<p>Extract the first four bytes from the double-hashed copy.
   These are used as a checksum to ensure the base hash gets transmitted
   correctly.</p>
</li>
<li>
<p>Append the checksum to the version and hash, and encode it as a base58
   string: <!--[--><code>BASE58(version . hash . checksum)</code><!--]--></p>
</li>
</ol>
<p>Pinkcoin's own code can be traced using the base58 header
file.
To convert addresses back into hashes, reverse the base58 encoding, extract
the checksum, repeat the steps to create the checksum and compare it
against the extracted checksum, and then remove the version byte.</p>
<h2 id="raw-transaction-format">Raw Transaction Format</h2>
<p>Bitcoin transactions are broadcast between peers
in a serialized byte format, called raw format.
It is this form of a transaction which is SHA256(SHA256()) hashed to create
the TXID and, ultimately, the merkle root of a block containing the
transaction---making the transaction format part of the consensus rules.</p>
<p>Bitcoin Core and many other tools print and accept raw transactions
encoded as hex.</p>
<p>As of Bitcoin Core 0.9.3 (October 2014), all transactions use the
version 1 format described below. (Note: transactions in the block chain
are allowed to list a higher version number to permit soft forks, but
they are treated as version 1 transactions by current software.)</p>
<p>A raw transaction has the following top-level format:</p>
<table>
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>version</td>
<td>uint32_t</td>
<td>Transaction version number; currently version 1.  Programs creating transactions using newer consensus rules may use higher version numbers.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>tx_in count</td>
<td>compactSize uint</td>
<td>Number of inputs in this transaction.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>tx_in</td>
<td>txIn</td>
<td>Transaction inputs.  See description of txIn below.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>tx_out count</td>
<td>compactSize uint</td>
<td>Number of outputs in this transaction.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>tx_out</td>
<td>txOut</td>
<td>Transaction outputs.  See description of txOut below.</td>
</tr>
<tr>
<td>4</td>
<td>lock_time</td>
<td>uint32_t</td>
<td>A time (Unix epoch time) or block number.  See the locktime parsing rules.</td>
</tr>
</tbody>
</table>
<p>A transaction may have multiple inputs and outputs, so the txIn and
txOut structures may recur within a transaction. CompactSize unsigned
integers are a form of variable-length integers; they are described in
the CompactSize section.</p>
<h3 id="txin-a-transaction-input-non-coinbase-txin">TxIn: A Transaction Input (Non-Coinbase) {#txin}</h3>
<p>Each non-coinbase input spends an outpoint from a previous transaction.
(Coinbase inputs are described separately after the example section below.)</p>
<table>
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>36</td>
<td>previous_output</td>
<td>outpoint</td>
<td>The previous outpoint being spent.  See description of outpoint below.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>script bytes</td>
<td>compactSize uint</td>
<td>The number of bytes in the signature script.  Maximum is 10,000 bytes.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>signature script</td>
<td>char[]</td>
<td>A script-language script which satisfies the conditions placed in the outpoint's pubkey script.  Should only contain data pushes; see the [signature script modification warning][].</td>
</tr>
<tr>
<td>4</td>
<td>sequence</td>
<td>uint32_t</td>
<td>Sequence number.  Default for Bitcoin Core and almost all other programs is 0xffffffff.</td>
</tr>
</tbody>
</table>
<h3 id="outpoint-the-specific-part-of-a-specific-output-outpoint">Outpoint: The Specific Part Of A Specific Output {#outpoint}</h3>
<p>Because a single transaction can include multiple outputs, the outpoint
structure includes both a TXID and an output index number to refer to
specific output.</p>
<table>
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>32</td>
<td>hash</td>
<td>char[32]</td>
<td>The TXID of the transaction holding the output to spend.  The TXID is a hash provided here in internal byte order.</td>
</tr>
<tr>
<td>4</td>
<td>index</td>
<td>uint32_t</td>
<td>The output index number of the specific output to spend from the transaction. The first output is 0x00000000.</td>
</tr>
</tbody>
</table>
<h3 id="txout-a-transaction-output-txout">TxOut: A Transaction Output {#txout}</h3>
<p>Each output spends a certain number of satoshis, placing them under
control of anyone who can satisfy the provided pubkey script.</p>
<table>
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>8</td>
<td>value</td>
<td>int64_t</td>
<td>Number of satoshis to spend.  May be zero; the sum of all outputs may not exceed the sum of satoshis previously spent to the outpoints provided in the input section.  (Exception: coinbase transactions spend the block subsidy and collected transaction fees.)</td>
</tr>
<tr>
<td>1+</td>
<td>pk_script bytes</td>
<td>compactSize uint</td>
<td>Number of bytes in the pubkey script.  Maximum is 10,000 bytes.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>pk_script</td>
<td>char[]</td>
<td>Defines the conditions which must be satisfied to spend this output.</td>
</tr>
</tbody>
</table>
<p><strong>Example</strong></p>
<p>The sample raw transaction itemized below is the one created in the
Simple Raw Transaction section of the
Developer Examples. It spends a previous pay-to-pubkey output by paying
to a new pay-to-pubkey-hash (P2PKH) output.</p>
<pre><code>01000000 ................................... Version

01 ......................................... Number of inputs
|
| 7b1eabe0209b1fe794124575ef807057
| c77ada2138ae4fa8d6c4de0398a14f3f ......... Outpoint TXID
| 00000000 ................................. Outpoint index number
|
| 49 ....................................... Bytes in sig. script: 73
| | 48 ..................................... Push 72 bytes as data
| | | 30450221008949f0cb400094ad2b5eb3
| | | 99d59d01c14d73d8fe6e96df1a7150de
| | | b388ab8935022079656090d7f6bac4c9
| | | a94e0aad311a4268e082a725f8aeae05
| | | 73fb12ff866a5f01 ..................... Secp256k1 signature
|
| ffffffff ................................. Sequence number: UINT32_MAX

01 ......................................... Number of outputs
| f0ca052a01000000 ......................... Satoshis (49.99990000 BTC)
|
| 19 ....................................... Bytes in pubkey script: 25
| | 76 ..................................... OP_DUP
| | a9 ..................................... OP_HASH160
| | 14 ..................................... Push 20 bytes as data
| | | cbc20a7664f2f69e5355aa427045bc15
| | | e7c6c772 ............................. PubKey hash
| | 88 ..................................... OP_EQUALVERIFY
| | ac ..................................... OP_CHECKSIG

00000000 ................................... locktime: 0 (a block height)
</code></pre>

<h3 id="coinbase-input-the-input-of-the-first-transaction-in-a-block-coinbase">Coinbase Input: The Input Of The First Transaction In A Block {#coinbase}</h3>
<p>The first transaction in a block, called the coinbase transaction, must
have exactly one input, called a coinbase. The coinbase input currently
has the following format.</p>
<table>
<thead>
<tr>
<th>Bytes</th>
<th>Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>32</td>
<td>hash (null)</td>
<td>char[32]</td>
<td>A 32-byte null, as a coinbase has no previous outpoint.</td>
</tr>
<tr>
<td>4</td>
<td>index (UINT32_MAX)</td>
<td>uint32_t</td>
<td>0xffffffff, as a coinbase has no previous outpoint.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>script bytes</td>
<td>compactSize uint</td>
<td>The number of bytes in the coinbase script, up to a maximum of 100 bytes.</td>
</tr>
<tr>
<td><em>Varies</em> (4)</td>
<td>height</td>
<td>script</td>
<td>The block height of this block as required by BIP34.  Uses script language: starts with a data-pushing opcode that indicates how many bytes to push to the stack followed by the block height as a little-endian unsigned integer.  This script must be as short as possible, otherwise it may be rejected.<br/><br/>  The data-pushing opcode will be 0x03 and the total size four bytes until block 16,777,216 about 300 years from now.</td>
</tr>
<tr>
<td><em>Varies</em></td>
<td>coinbase script</td>
<td><em>None</em></td>
<td>The coinbase field Arbitrary data not exceeding 100 bytes minus the (4) height bytes.  Miners commonly place an extra nonce in this field to update the block header merkle root during hashing.</td>
</tr>
<tr>
<td>4</td>
<td>sequence</td>
<td>uint32_t</td>
<td>Sequence number.</td>
</tr>
</tbody>
</table>
<p>Most (but not all) blocks prior to block height 227,836 used block
version 1 which did not require the height parameter to be prefixed to
the coinbase script.  The block height parameter is now required.</p>
<p>Although the coinbase script is arbitrary data, if it includes the
bytes used by any signature-checking operations such as <code>OP_CHECKSIG</code>,
those signature checks will be counted as signature operations (sigops)
towards the block's sigop limit.  To avoid this, you can prefix all data
with the appropriate push operation.</p>
<p>An itemized coinbase transaction:</p>
<pre><code>01000000 .............................. Version

01 .................................... Number of inputs
| 00000000000000000000000000000000
| 00000000000000000000000000000000 ...  Previous outpoint TXID
| ffffffff ............................ Previous outpoint index
|
| 29 .................................. Bytes in coinbase
| |
| | 03 ................................ Bytes in height
| | | 4e0105 .......................... Height: 328014
| |
| | 062f503253482f0472d35454085fffed
| | f2400000f90f54696d65202620486561
| | 6c74682021 ........................ Arbitrary data
| 00000000 ............................ Sequence

01 .................................... Output count
| 2c37449500000000 .................... Satoshis (25.04275756 BTC)
| 1976a914a09be8040cbf399926aeb1f4
| 70c37d1341f3b46588ac ................ P2PKH script
| 00000000 ............................ Locktime
</code></pre>

<h2 id="compactsize-unsigned-integers">CompactSize Unsigned Integers</h2>
<p>The raw transaction format and several peer-to-peer network messages use
a type of variable-length integer to indicate the number of bytes in a
following piece of data.</p>
<p>Bitcoin Core code and this document refers to these variable length
integers as compactSize. Many other documents refer to them as var_int
or varInt, but this risks conflation with other variable-length integer
encodings---such as the CVarInt class used in Bitcoin Core for
serializing data to disk.  Because it's used in the transaction format,
the format of compactSize unsigned integers is part of the consensus
rules.</p>
<p>For numbers from 0 to 252, compactSize unsigned integers look like
regular unsigned integers. For other numbers up to 0xffffffffffffffff, a
byte is prefixed to the number to indicate its length---but otherwise
the numbers look like regular unsigned integers in little-endian order.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Bytes Used</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;= 0 &amp;&amp; &lt;= 252</td>
<td>1</td>
<td>uint8_t</td>
</tr>
<tr>
<td>&gt;= 253 &amp;&amp; &lt;= 0xffff</td>
<td>3</td>
<td>0xfd followed by the number as uint16_t</td>
</tr>
<tr>
<td>&gt;= 0x10000 &amp;&amp; &lt;= 0xffffffff</td>
<td>5</td>
<td>0xfe followed by the number as uint32_t</td>
</tr>
<tr>
<td>&gt;= 0x100000000 &amp;&amp; &lt;= 0xffffffffffffffff</td>
<td>9</td>
<td>0xff followed by the number as uint64_t</td>
</tr>
</tbody>
</table>
<p>For example, the number 515 is encoded as 0xfd0302.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../block-chain/" title="Blockchain" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Blockchain
              </span>
            </div>
          </a>
        
        
          <a href="../p2p/" title="P2P Network" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                P2P Network
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.a46cbbdf.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:".."}})</script>
      
        <script src="../search/require.js"></script>
      
        <script src="../search/search.js"></script>
      
    
    
      
    
  </body>
</html>